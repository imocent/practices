<!DOCTYPE html>
<html lang="zh-CN">
<head th:include="include :: head('做题吧 - 答题室')"></head>
<body>
<th:block th:include="include :: f_header"></th:block>
<div class="layui-container layui-fluid" style="margin-top:10px">
    <div class="layui-row layui-col-space20">
        <!-- 左侧：课程信息 -->
        <div class="layui-col-md8 layui-card">
            <div class="layui-card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)">
                <i class="layui-icon layui-icon-template-1"></i> <span style="color: #fff;" th:text="${room?.title}">实战课程</span>
            </div>
            <div class="layui-card-body" id="ID-body" th:text="${room?.content}">
                <ul class="layui-timeline">
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content layui-text">
                            <h3 class="layui-timeline-title">Vue 3.0 核心特性</h3>
                            <p>全面讲解Composition API、响应式系统、Teleport、Fragments等Vue 3.0新特性</p>
                        </div>
                    </li>
                    <li class="layui-timeline-item">
                        我是广告位
                    </li>
                </ul>
            </div>
            <div class="layui-card-body layui-hide" id="ID-flow" style="height: 570px; overflow: auto;"></div>
        </div>
        <!-- 右侧：答题室信息 -->
        <div class="layui-col-md4">
            <!-- 答题室卡片 -->
            <div class="layui-card">
                <div class="layui-card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)">
                    <i class="layui-icon layui-icon-list"></i>
                    <span>测试答题室</span>
                    <span class="layui-badge" style="float: right;">永久有效</span>
                </div>
                <div class="room layui-card-body">
                    <ul class="layui-row layui-col-space10">
                        <li class="layui-col-md12">
                            <span class="layui-col-xs2 layui-col-sm2 layui-col-md2">类型: </span>
                            <span class="layui-col-xs10 layui-col-sm10 layui-col-md10">标准答题</span>
                        </li>
                        <li class="layui-col-md12">
                            <span class="layui-col-xs2 layui-col-sm2 layui-col-md2">条件: </span>
                            <span class="layui-col-xs10 layui-col-sm10 layui-col-md10">时长10分 / 任何人员</span>
                        </li>
                        <li class="layui-col-md12">
                            <span class="layui-col-xs2 layui-col-sm2 layui-col-md2">分类: </span>
                            <span class="layui-col-xs10 layui-col-sm10 layui-col-md10">默认答题室</span>
                        </li>
                        <li class="layui-col-md12">
                            <span class="layui-col-xs2 layui-col-sm2 layui-col-md2">状态: </span>
                            <span class="layui-col-xs10 layui-col-sm10 layui-col-md10">开始答题</span>
                        </li>
                    </ul>
                    <!-- 答题室人数 -->
                    <div class="layui-card laytable-cell-space" style="background: #f8f8f8; margin: 20px 0;">
                        <div class="layui-card-body">
                            <div style="font-size: 36px; color: #1E9FFF; font-weight: bold;">1/1</div>
                            <div style="color: #666;">进入答题室人数</div>
                        </div>
                    </div>
                    <!-- 操作按钮 -->
                    <button class="layui-btn layui-btn-fluid layui-btn-primary layui-border-red" th:data-room-id="${room.id}">
                        <i class="layui-icon">&#xe652; 开始答题</i>
                        <i class="layui-icon layui-hide">&#xe6cc; 结束答题</i>
                    </button>
                </div>
            </div>
            <!-- 答题须知 -->
            <div class="layui-card" style="margin-top: 20px;">
                <div class="layui-card-header">
                    <i class="layui-icon">&#xe702; 答题须知</i>
                </div>
                <div class="layui-card-body">
                    <div class="layui-collapse">
                        <div class="layui-colla-item">
                            <h2 class="layui-colla-title">答题规则</h2>
                            <div class="layui-colla-content layui-show">
                                <p>1. 答题时长限制为10分钟，超时自动提交</p>
                                <p>2. 答题过程中不可切换页面，否则可能被判定为异常</p>
                                <p>3. 每人仅有一次答题机会，请谨慎作答</p>
                            </div>
                        </div>
                        <div class="layui-colla-item">
                            <h2 class="layui-colla-title">评分标准</h2>
                            <div class="layui-colla-content">
                                <p>1. 单选题每题10分，多选题每题20分</p>
                                <p>2. 答题正确率需达到60%以上方可通过</p>
                                <p>3. 答题结束后可立即查看分数和解析</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<th:block th:include="include :: f_footer"></th:block>
<!-- 引入 LayUI JS -->
<script src="/js/layui.js"></script>
<script>
    layui.use(['jquery', 'element', 'form', 'flow'], function ($, element, form, flow) {
        // 初始化折叠面板
        element.render('collapse');

        $('.room').on('click', '.layui-btn', function (e) {
            e.stopPropagation();
            var $btn = $(this);
            var roomId = $btn.data('room-id');
            $btn.toggleClass('layui-border-red layui-border-green');
            // 切换两个图标的显示状态
            $btn.find('i').toggleClass('layui-hide');
            // 根据当前状态执行不同逻辑
            if ($btn.hasClass('layui-border-green')) {
                console.log('开始答题 - 房间ID:', roomId);
                $('#ID-body').addClass('layui-hide');
                $('#ID-flow').removeClass('layui-hide');
            } else {
                console.log('结束答题 - 房间ID:', roomId);
                $('#ID-body').removeClass('layui-hide');
                $('#ID-flow').addClass('layui-hide');
            }
        });

        flow.load({
            elem: '#ID-flow',
            scrollElem: '#ID-flow',
            done: function (page, next) {
                console.log(page)
                setTimeout(function(){
                    var lis = [];
                    for(var i = 0; i < 8; i++){
                        lis.push('<li>'+ ( (page-1)*8 + i + 1 ) +'</li>')
                    }
                    next(lis.join(''), page < 10);
                }, 520);
            }
        });
    });
</script>
</body>
</html>