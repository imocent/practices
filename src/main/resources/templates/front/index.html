<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="include :: head('做题吧 - 首页')"></head>
<link rel="stylesheet" type="text/css" th:href="@{/css/index.css}"/>
<body>
<div th:include="include :: f_header"></div>
<!-- 搜索区域 -->
<div class="search-section">
    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-carousel" id="banner">
                <div carousel-item>
                    <div th:each="top : ${tops}">
                        <img th:src="${#strings.isEmpty(top.url)?'/images/none.png':top.url}" th:alt="${top.title}"/>
                    </div>
                </div>
            </div>
            <div class="layui-col-md8 layui-col-md-offset2">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h1 style="font-size: 28px; color: #333; margin-bottom: 20px;">探索知识，提升技能</h1>
                    <p style="color: #666; font-size: 16px;">专业的IT技能学习平台，助力您的职业成长</p>
                </div>

                <div class="layui-form">
                    <div class="layui-input-group" style="width: 100%;">
                        <input type="text" class="layui-input layui-search" placeholder="搜索课程、知识库内容..."/>
                        <div class="layui-input-suffix">
                            <button class="layui-btn layui-bg-purple layui-search-btn">
                                <i class="layui-icon layui-icon-search"></i> 搜索
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 热门课程 -->
<div class="layui-container" style="margin-bottom: 40px;">
    <div class="layui-row">
        <div class="layui-col-md12">
            <div class="section-title">
                <span>热门课程</span>
                <a th:href="@{/rooms}" class="layui-btn layui-btn-primary layui-btn-sm"
                   style="float: right;">更多课程</a>
            </div>
        </div>
    </div>
    <div class="rooms layui-row layui-col-space20">
        <div class="layui-col-md4 layui-col-sm6" th:each="room : ${rooms}" th:data-room-id="${room.id}">
            <div class="layui-card" style="border: 1px solid #EEEEEE">
                <div class="layui-card-header" style="background: #E2E2E2; color: black;">
                    <i class="layui-icon layui-icon-component"></i> <span th:text="${room?.name}">答题室标题</span>
                    <span class="layui-badge" style="float: right; color: white;"
                          th:text="${room?.timeMode==1?'限时答题':'永久有效'}">永久有效</span>
                </div>
                <div class="layui-card-body layui-row fixed-content-height">
                    <div class="layui-col-md8">
                        <div class="layui-row">
                            <p class="content-area" th:text="${room?.content}">答题室内容</p>
                            <div class="layui-col-xs12">
                                <span class="layui-badge layui-bg-blue">标准答题</span>
                                <span class="layui-border-red" th:text="${room?.timeLen}">15</span>分钟
                            </div>
                            <span style="margin-top: 5px;" class="layui-badge layui-bg-green">进行中</span>
                            <span style="color: #666; margin: 5px 0 0 10px;">考试分类</span>
                        </div>
                    </div>
                    <div class="layui-col-md4">
                        <img src="/images/logo.png" style="height: 120px;padding: 8px;display: flex;"/>
                    </div>
                    <hr/>
                    <div class="layui-row layui-col-space5" style="margin-top: 10px;">
                        <div class="layui-col-xs6">
                            <button class="layui-btn layui-btn-fluid layui-btn-primary layui-border-purple">
                                <i class="layui-icon layui-icon-play"></i> 进入答题室
                            </button>
                        </div>
                        <div class="layui-col-xs6">
                            <button class="layui-btn layui-btn-fluid layui-btn-primary layui-border-orange">
                                <i class="layui-icon layui-icon-file-b"></i> 报告
                            </button>
                        </div>
                    </div>
                    <button class="layui-btn layui-btn-fluid layui-btn-primary layui-border-red"
                            th:classappend="${role==5?'layui-hide':''}">
                        <i class="layui-icon layui-icon-edit"></i> 阅卷
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 底部信息 -->
<div th:include="include :: f_footer"></div>
<script>
    layui.use(['jquery', 'element', 'form', 'carousel', 'dropdown'], function ($, element, form, carousel, dropdown) {
        carousel.render({
            elem: '#banner',        // 绑定容器
            width: '100%',           // 宽度自适应
            height: '300px',         // 高度可调
            interval: 3000,          // 切换间隔
            anim: 'fade',            // 动画效果（可选：fade/updown）
            arrow: 'hover',          // 箭头显示方式
            indicator: 'outside'     // 指示器位置
        });

        $.get('/subjects', function (res) {
            dropdown.render({
                elem: '.LAY_TRIGGER',
                trigger: 'click',
                data: res.data || [],
                click: function (data, othis, event) {
                    console.log(data);
                    console.log(othis);
                    console.log(this.elem);
                    console.log(event);
                }
            });
        }, 'json');

        $('.rooms').on('click', '.layui-btn', function (e) {
            e.stopPropagation();
            var $btn = $(this);
            var $card = $btn.closest('.layui-card');
            var roomId = $card.parent().data('roomId');
            if ($btn.hasClass('layui-border-purple')) {
                console.log("答题室" + roomId)
                location.href = "/detail?id=" + roomId;
            } else if ($btn.hasClass('layui-border-orange')) {
                console.log("报告" + roomId)
            } else if ($btn.hasClass('layui-border-red')) {
                console.log("阅卷" + roomId)
            }
        });
    });
</script>
</body>
</html>