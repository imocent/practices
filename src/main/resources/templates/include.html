<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!-- 头部信息 -->
<head th:fragment="head(title)">
    <title th:text="${title}"></title>
    <meta charset="utf-8"/>
    <meta name="renderer" content="webkit|ie-comp|ie-stand"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="Bookmark" th:href="@{/favicon.ico}"/>
    <link rel="Shortcut Icon" th:href="@{/favicon.ico}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/layui.css}" media="all"/>
    <script type="text/javascript" charset="utf-8" th:src="@{/js/layui.js}"></script>
    <script type="text/javascript" charset="utf-8" th:src="@{/js/lay-config.js}"></script>
    <!--[if lt IE 9]>
    <script type="text/javascript" th:src="@{/js/html5shiv.js}"></script>
    <script type="text/javascript" th:src="@{/js/respond.min.js}"></script><![endif]--><!--[if IE 6]>
    <script type="text/javascript" th:src="@{/js/DD_belatedPNG_0.0.8a-min.js}"></script>
    <script>DD_belatedPNG.fix('*');</script><![endif]-->
</head>
<!-- 头部信息 -->
<div th:fragment="header">
    <div class="layui-header">
        <!-- logo 区域 -->
        <div class="layui-logo">
            <img th:src="@{/images/logo.png}" alt="logo" style="margin-left: -5px;"/>
            <cite>管理系统</cite>
        </div>
        <!-- 头部区域 -->
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item">
                <a lay-event="flexible" title="侧边伸缩" lay-unselect>
                    <i class="layui-icon layui-icon-shrink-right"></i>
                </a>
            </li>
            <!-- 面包屑 -->
            <span class="layui-breadcrumb layui-anim layui-anim-up">
                <a><cite>首页</cite></a>
            </span>
        </ul>
        <!-- 头像区域 -->
        <ul class="layui-nav layui-layout-right">
            <!--<li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a lay-event="clear" title="清理">
                    <i class="layui-icon layui-icon-delete"></i>
                </a>
            </li>-->
            <li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a href="/" target="_blank" title="文档说明">
                    <i class="layui-icon layui-icon-website"></i>
                </a>
            </li>
            <li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a id="layFull" lay-event="screenLayFull" lay-full="full" title="全屏">
                    <i class="layui-icon layui-icon-screen-full"></i>
                </a>
            </li>
            <li class="layui-nav-item user-selection">
                <a>
                    <img th:src="@{/images/logo.png}" class="layui-nav-img" alt="头像">
                    <cite style="margin: 0 10px;">[[${session.username?:'用户'}]]</cite>
                </a>
                <dl class="layui-nav-child">
                    <dd lay-unselect><a lay-event="userInfo">基本资料</a></dd>
                    <dd lay-unselect><a lay-event="editPwd">修改密码</a></dd>
                    <hr>
                    <dd lay-unselect><a th:href="@{/logout}">退出</a></dd>
                </dl>
            </li>
        </ul>
    </div>
</div>
</div>

<!-- 尾部信息 -->
<div th:fragment="footer">
    <div class="layui-footer">
        <p>© 2025 <a href="#" target="_blank">做题吧</a> 版权所有 | 冀ICP备12345678号</p>
    </div>
    <!-- 移动端遮罩 -->
    <div class="site-mobile-shade"></div>
</div>

<div th:fragment="f_header">
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin-bottom: 20px;">
        <div class="layui-container">
            <div class="layui-header">
                <div class="layui-row">
                    <!-- Logo -->
                    <div class="layui-logo" style="color: #fff; font-size: 22px; height: 60px; line-height: 45px;">
                        <img th:src="@{/images/logo.png}" alt="logo" height="30px"/>
                        <cite>做题吧</cite>
                    </div>
                    <!-- 导航菜单 - LayUI会自动处理手机端适配 -->
                    <ul class="layui-nav layui-layout-left" style="background: transparent;" id="mainNav">
                        <li class="layui-nav-item" data-page="home">
                            <a href="/" style="color: #fff;">首页</a>
                        </li>
                        <li class="layui-nav-item LAY_TRIGGER" data-page="rooms">
                            <a href="/rooms" style="color: #fff;">课程中心 <i class="layui-icon">&#xe61a;</i></a>
                        </li>
                        <li class="layui-nav-item LAY_TRIG" data-page="learn">
                            <a href="/learn" style="color: #fff;">知识库 <i class="layui-icon">&#xe61a;</i></a>
                        </li>
                        <li class="layui-nav-item" data-page="projects">
                            <a href="/projects" style="color: #fff;">实战项目</a>
                        </li>
                        <li class="layui-nav-item" data-page="community">
                            <a href="/community" style="color: #fff;">问答社区</a>
                        </li>
                    </ul>
                    <!-- 右侧登录 -->
                    <ul class="layui-nav layui-layout-right" style="background: transparent;">
                        <li class="layui-nav-item" th:if="${session.username!= null}">
                            <a>
                                <img th:src="@{/images/logo.png}" class="layui-nav-img" alt="头像">
                                <cite style="margin: 0 10px;">[[${session.username?:'用户'}]]</cite>
                            </a>
                            <dl class="layui-nav-child">
                                <dd lay-unselect><a lay-event="userInfo">基本资料</a></dd>
                                <dd lay-unselect><a lay-event="editPwd">修改密码</a></dd>
                                <hr>
                                <dd lay-unselect><a th:href="@{/logout}">退出</a></dd>
                            </dl>
                        </li>
                        <li class="layui-nav-item" th:unless="${session.username!= null}">
                            <a th:href="@{/login}" style="color: #fff;">
                                <i class="layui-icon layui-icon-username"></i> 登录
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="f_footer">
    <div class="footer">
        <div class="layui-container">
            <div class="layui-row" style="padding: 40px 0;">
                <div class="layui-col-md6">
                    <div style="font-size: 20px; font-weight: bold; margin-bottom: 15px; color: #fff;">做题吧平台</div>
                    <div style="color: #bdc3c7; line-height: 1.6; margin-bottom: 20px;">
                        专注于提供高质量的在线做题平台，帮助您实现成长。
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div style="color: #ecf0f1; font-weight: bold; margin-bottom: 15px;">学习资源</div>
                    <div style="color: #bdc3c7;">
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">课程中心</a>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">知识库</a></div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">实战项目</a>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div style="color: #ecf0f1; font-weight: bold; margin-bottom: 15px;">服务支持</div>
                    <div style="color: #bdc3c7;">
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">帮助中心</a>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">常见问题</a>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">联系我们</a>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div style="color: #ecf0f1; font-weight: bold; margin-bottom: 15px;">关于我们</div>
                    <div style="color: #bdc3c7;">
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">公司介绍</a>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">加入我们</a>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <a href="#" style="color: #bdc3c7; text-decoration: none;">隐私政策</a>
                        </div>
                    </div>
                </div>
                <div th:include="include :: footer"></div>
            </div>
        </div>
    </div>
    <script>
        layui.use(['jquery', 'element', 'form', 'carousel', 'dropdown'], function ($, element, form, carousel, dropdown) {

            var pageMap = {
                '/': 'home',
                '/index.html': 'home',
                '/index': 'home',
                '/rooms': 'rooms',
                '/rooms.html': 'rooms',
                '/knowledge': 'knowledge',
                '/knowledge.html': 'knowledge',
                '/projects': 'projects',
                '/projects.html': 'projects',
                '/community': 'community',
                '/community.html': 'community'
            };
            // 获取当前页面标识
            var currentPath = window.location.pathname;
            var currentPageKey = pageMap[currentPath] || 'home';
            // 移除所有active状态
            $('.layui-nav-item').removeClass('layui-this');
            // 设置当前active状态
            $('#mainNav .layui-nav-item[data-page="' + currentPageKey + '"]').addClass('layui-this');
            // 重新渲染
            element.init();

            carousel.render({
                elem: '#banner',        // 绑定容器
                width: '100%',           // 宽度自适应
                height: '300px',         // 高度可调
                interval: 3000,          // 切换间隔
                anim: 'fade',            // 动画效果（可选：fade/updown）
                arrow: 'hover',          // 箭头显示方式
                indicator: 'outside'     // 指示器位置
            });

            $.get('/subjects', function (res) {
                dropdown.render({
                    elem: '.LAY_TRIGGER',
                    trigger: 'click',
                    data: res.data || [],
                    click: function (data, othis, event) {
                        console.log(data);
                        console.log(othis);
                        console.log(this.elem);
                        console.log(event);
                    }
                });
                dropdown.render({
                    elem: '.LAY_TRIG',
                    trigger: 'click',
                    data: res.data || [],
                    click: function (data, othis, event) {
                        console.log(data);
                        console.log(othis);
                        console.log(this.elem);
                        console.log(event);
                    }
                });
            }, 'json');

            $('.rooms').on('click', '.layui-btn', function (e) {
                e.stopPropagation();
                var $btn = $(this);
                var $card = $btn.closest('.layui-card');
                var roomId = $card.parent().data('roomId');
                if ($btn.hasClass('layui-border-purple')) {
                    console.log("答题室" + roomId)
                    location.href = "/detail?id=" + roomId;
                } else if ($btn.hasClass('layui-border-orange')) {
                    console.log("报告" + roomId)
                } else if ($btn.hasClass('layui-border-red')) {
                    console.log("阅卷" + roomId)
                }
            });
        });
    </script>
</div>
</html>