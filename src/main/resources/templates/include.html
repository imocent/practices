<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!-- 头部信息 -->
<head th:fragment="head(title)">
    <title th:text="${title}"></title>
    <meta charset="utf-8"/>
    <meta name="renderer" content="webkit|ie-comp|ie-stand"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="Bookmark" th:href="@{/favicon.ico}"/>
    <link rel="Shortcut Icon" th:href="@{/favicon.ico}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/layui.css}" media="all"/>
    <link rel="stylesheet" type="text/css" th:unless="${#request.servletPath.startsWith('/admin')}" th:href="@{/css/index.css}"/>
    <script type="text/javascript" th:src="@{/js/layui.js}"></script>
    <!--[if lt IE 9]>
    <script type="text/javascript" th:src="@{/js/html5shiv.js}"></script>
    <script type="text/javascript" th:src="@{/js/respond.min.js}"></script><![endif]--><!--[if IE 6]>
    <script type="text/javascript" th:src="@{/js/DD_belatedPNG_0.0.8a-min.js}"></script>
    <script>DD_belatedPNG.fix('*');</script><![endif]-->
    <script type="text/javascript" th:if="${#request.servletPath.startsWith('/admin')}" th:src="@{/js/lay-config.js}"></script>
    <script type="text/javascript" th:unless="${#request.servletPath.startsWith('/admin')}">
        function layPage(id, count, curr, limit) {
            layui.laypage.render({
                elem: id,
                count: count,
                curr: curr || 1,
                limit: limit || 12,
                theme: '#B55AD0',
                first: '首页',
                last: '尾页',
                prev: '<em>←</em>',
                next: '<em>→</em>',
                jump: function (obj, first) {
                    if (!first) {
                        console.log(window.location.pathname)
                        // window.location.href = window.location.pathname
                    }
                }
            });
        }

        layui.use(['jquery', 'element', 'form', 'carousel', 'dropdown'], function ($, element, form, carousel, dropdown) {
            var pageMap = {
                '/': 'home', '/index': 'home', '/index.html': 'home',
                '/room': 'rooms', '/room.html': 'rooms',
                '/rooms': 'rooms', '/rooms.html': 'rooms',
                '/learns': 'learns', '/learns.html': 'learns',
                '/comment': 'comments', '/comment.html': 'comments',
                '/comments': 'comments', '/comments.html': 'comments',
                '/tools': 'tools', '/tools.html': 'tools',
            };
            // 获取当前页面标识
            var dataPageKey = pageMap[window.location.pathname] || 'home';
            // 移除所有active状态
            $('.layui-nav-item').removeClass('layui-this');
            // 设置当前active状态
            $('#mainNav .layui-nav-item[data-page="' + dataPageKey + '"]').addClass('layui-this');
            // 重新渲染
            element.init();

            carousel.render({
                elem: '#banner',        // 绑定容器
                width: '100%',           // 宽度自适应
                height: '300px',         // 高度可调
                interval: 3000,          // 切换间隔
                anim: 'fade',            // 动画效果（可选：fade/updown）
                arrow: 'hover',          // 箭头显示方式
                indicator: 'outside'     // 指示器位置
            });

            $.get('/subjects', function (res) {
                dropdown.render({
                    elem: '.LAY_TRIGGER',
                    trigger: 'click',
                    data: res.data || [],
                    click: function (data, othis, event) {
                        window.location.href = "/rooms?sid=" + data.id;
                    }
                });
                dropdown.render({
                    elem: '.LAY_TRIG',
                    trigger: 'click',
                    data: res.data || [],
                    click: function (data, othis, event) {
                        window.location.href = "/learns?sid=" + data.id;
                    }
                });
            }, 'json');

            $('.rooms').on('click', '.layui-btn', function (e) {
                e.stopPropagation();
                var $btn = $(this);
                var $card = $btn.closest('.layui-card');
                var roomId = $card.parent().data('roomId');
                if ($btn.hasClass('layui-border-purple')) {
                    console.log("答题室" + roomId)
                    window.location.href = "/room?id=" + roomId;
                } else if ($btn.hasClass('layui-border-orange')) {
                    console.log("报告" + roomId)
                } else if ($btn.hasClass('layui-border-red')) {
                    console.log("阅卷" + roomId)
                }
            });
        });
    </script>
</head>
<!-- 头部信息 -->
<div th:fragment="header">
    <div class="layui-header">
        <div class="layui-logo">
            <img th:src="@{/images/logo.png}" alt="logo" style="margin-left: -5px;"/>
            <cite>管理系统</cite>
        </div>
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item">
                <a lay-event="flexible" title="侧边伸缩" lay-unselect>
                    <i class="layui-icon layui-icon-shrink-right"></i>
                </a>
            </li>
            <span class="layui-breadcrumb layui-anim layui-anim-up">
                <a><cite>首页</cite></a>
            </span>
        </ul>
        <ul class="layui-nav layui-layout-right">
            <!--<li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a lay-event="clear" title="清理">
                    <i class="layui-icon layui-icon-delete"></i>
                </a>
            </li>-->
            <li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a href="/" target="_blank" title="文档说明">
                    <i class="layui-icon layui-icon-website"></i>
                </a>
            </li>
            <li class="layui-nav-item layui-hide-xs" lay-unselect>
                <a id="layFull" lay-event="screenLayFull" lay-full="full" title="全屏">
                    <i class="layui-icon layui-icon-screen-full"></i>
                </a>
            </li>
            <li class="layui-nav-item user-selection">
                <a>
                    <img th:src="@{/images/logo.png}" class="layui-nav-img" alt="头像">
                    <cite style="margin: 0 10px;">[[${session.username?:'用户'}]]</cite>
                </a>
                <dl class="layui-nav-child">
                    <dd lay-unselect><a lay-event="userInfo">基本资料</a></dd>
                    <dd lay-unselect><a lay-event="editPwd">修改密码</a></dd>
                    <hr>
                    <dd lay-unselect><a th:href="@{/logout}">退出</a></dd>
                </dl>
            </li>
        </ul>
    </div>
</div>

<!-- 尾部信息 -->
<div th:fragment="footer">
    <div class="layui-footer">
        <p>© 2025 <a href="#" target="_blank" style="color: #3498db; text-decoration: none;">做题吧</a> 版权所有 | 冀ICP备12345678号</p>
    </div>
    <!-- 移动端遮罩 -->
    <div class="site-mobile-shade"></div>
</div>

<div th:fragment="f_header">
    <div class="layui-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="layui-container layui-row" style="margin-bottom: 20px;">
            <div class="layui-logo" style="color: #fff; font-size: 22px; padding-top: 10px;">
                <img th:src="@{/images/logo.png}" alt="logo" height="30px"/>
                <cite>做题吧</cite>
            </div>
            <ul id="mainNav" class="layui-nav layui-layout-left" style="background: transparent;">
                <li class="layui-nav-item" data-page="home">
                    <a href="/" style="color: #fff;">首页</a>
                </li>
                <li class="layui-nav-item LAY_TRIGGER" data-page="rooms">
                    <a href="/rooms" style="color: #fff;">课程中心 <i class="layui-icon">&#xe61a;</i></a>
                </li>
                <li class="layui-nav-item LAY_TRIG" data-page="learns">
                    <a href="/learns" style="color: #fff;">知识库 <i class="layui-icon">&#xe61a;</i></a>
                </li>
                <li class="layui-nav-item" data-page="comments">
                    <a href="/comment" style="color: #fff;">问答社区</a>
                </li>
                <li class="layui-nav-item" data-page="tools">
                    <a href="/tools" style="color: #fff;">常用工具</a>
                </li>
            </ul>
            <ul class="layui-nav layui-layout-right" style="background: transparent;">
                <li class="layui-nav-item" th:if="${session.username!= null}">
                    <a>
                        <img th:src="@{/images/logo.png}" class="layui-nav-img" alt="头像">
                        <cite style="margin: 0 10px;">[[${session.username?:'用户'}]]</cite>
                    </a>
                    <dl class="layui-nav-child">
                        <dd lay-unselect><a lay-event="userInfo">基本资料</a></dd>
                        <dd lay-unselect><a lay-event="editPwd">修改密码</a></dd>
                        <hr>
                        <dd lay-unselect><a th:href="@{/logout}">退出</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item" th:unless="${session.username!= null}">
                    <a th:href="@{/login}" style="color: #fff;">
                        <i class="layui-icon layui-icon-username"></i> 登录
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>

<div th:fragment="f_footer">
    <div class="layui-footer" style="background: #2c3e50; color: #fff; padding: 40px 0 20px; margin-top: auto;">
        <div class="layui-container layui-row" style="margin-bottom:15px;">
            <div class="layui-col-md6">
                <div class="layui-font-20">
                    <img src="/images/logo.png" alt="logo" height="24px" style="vertical-align: middle; margin-right: 10px;">
                    做题吧平台
                </div>
                <div class="layui-font-14" style="color: #bdc3c7; line-height: 1.6; margin: 10px 40px 10px 0;">
                    专注于提供高质量的在线做题平台，帮助您实现成长。我们致力于为用户提供最优质的学习体验。
                </div>
            </div>
            <div class="layui-col-md6">
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
                    <div class="layui-font-16">学习资源</div>
                    <div class="layui-font-14">
                        <a href="/rooms" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">课程中心</a>
                        <a href="/learns" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">知识库</a>
                    </div>
                </div>
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
                    <div class="layui-font-16">服务支持</div>
                    <div class="layui-font-14">
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">帮助中心</a>
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">常见问题</a>
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">联系我们</a>
                    </div>
                </div>
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
                    <div class="layui-font-16">关于我们</div>
                    <div class="layui-font-14">
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">公司介绍</a>
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">加入我们</a>
                        <a href="#" style="color: #bdc3c7;display: block;margin: 0 15px 10px 0;">隐私政策</a>
                    </div>
                </div>
            </div>
            <th:block th:include="include :: footer"></th:block>
        </div>
    </div>
    <div class="site-mobile-shade" th:alt="移动端遮罩"></div>
</div>
</html>